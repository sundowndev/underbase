<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>node_modules/aws4/README · Underbase</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;aws4&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="node_modules/aws4/README · Underbase"/><meta property="og:type" content="website"/><meta property="og:url" content="https://sundowndev.github.io/underbase/"/><meta property="og:description" content="&lt;p&gt;aws4&lt;/p&gt;
"/><meta property="og:image" content="https://sundowndev.github.io/underbase/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://sundowndev.github.io/underbase/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/underbase/img/logo.svg"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://sundowndev.github.io/underbase/blog/atom.xml" title="Underbase Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://sundowndev.github.io/underbase/blog/feed.xml" title="Underbase Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/underbase/js/scrollSpy.js"></script><link rel="stylesheet" href="/underbase/css/main.css"/><script src="/underbase/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/underbase/"><img class="logo" src="/underbase/img/logo.svg" alt="Underbase"/><h2 class="headerTitleWithLogo">Underbase</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/underbase/docs/installation" target="_self">Guides</a></li><li class=""><a href="/underbase/docs/api" target="_self">API</a></li><li class=""><a href="/underbase/blog/" target="_self">Release notes</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">node_modules/aws4/README</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="aws4"></a><a href="#aws4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>aws4</h2>
<p><a href="http://travis-ci.org/mhart/aws4"><img src="https://secure.travis-ci.org/mhart/aws4.png?branch=master" alt="Build Status"></a></p>
<p>A small utility to sign vanilla node.js http(s) request options using Amazon's
<a href="http://docs.amazonwebservices.com/general/latest/gr/signature-version-4.html">AWS Signature Version 4</a>.</p>
<p>Can also be used <a href="./browser">in the browser</a>.</p>
<p>This signature is supported by nearly all Amazon services, including
<a href="http://docs.aws.amazon.com/AmazonS3/latest/API/">S3</a>,
<a href="http://docs.aws.amazon.com/AWSEC2/latest/APIReference/">EC2</a>,
<a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/API.html">DynamoDB</a>,
<a href="http://docs.aws.amazon.com/kinesis/latest/APIReference/">Kinesis</a>,
<a href="http://docs.aws.amazon.com/lambda/latest/dg/API_Reference.html">Lambda</a>,
<a href="http://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/">SQS</a>,
<a href="http://docs.aws.amazon.com/sns/latest/api/">SNS</a>,
<a href="http://docs.aws.amazon.com/IAM/latest/APIReference/">IAM</a>,
<a href="http://docs.aws.amazon.com/STS/latest/APIReference/">STS</a>,
<a href="http://docs.aws.amazon.com/AmazonRDS/latest/APIReference/">RDS</a>,
<a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/">CloudWatch</a>,
<a href="http://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/">CloudWatch Logs</a>,
<a href="http://docs.aws.amazon.com/codedeploy/latest/APIReference/">CodeDeploy</a>,
<a href="http://docs.aws.amazon.com/AmazonCloudFront/latest/APIReference/">CloudFront</a>,
<a href="http://docs.aws.amazon.com/awscloudtrail/latest/APIReference/">CloudTrail</a>,
<a href="http://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/">ElastiCache</a>,
<a href="http://docs.aws.amazon.com/ElasticMapReduce/latest/API/">EMR</a>,
<a href="http://docs.aws.amazon.com/amazonglacier/latest/dev/amazon-glacier-api.html">Glacier</a>,
<a href="http://docs.aws.amazon.com/cloudsearch/latest/developerguide/APIReq.html">CloudSearch</a>,
<a href="http://docs.aws.amazon.com/ElasticLoadBalancing/latest/APIReference/">Elastic Load Balancing</a>,
<a href="http://docs.aws.amazon.com/elastictranscoder/latest/developerguide/api-reference.html">Elastic Transcoder</a>,
<a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/">CloudFormation</a>,
<a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/api/">Elastic Beanstalk</a>,
<a href="http://docs.aws.amazon.com/storagegateway/latest/userguide/AWSStorageGatewayAPI.html">Storage Gateway</a>,
<a href="http://docs.aws.amazon.com/datapipeline/latest/APIReference/">Data Pipeline</a>,
<a href="http://docs.aws.amazon.com/directconnect/latest/APIReference/">Direct Connect</a>,
<a href="http://docs.aws.amazon.com/redshift/latest/APIReference/">Redshift</a>,
<a href="http://docs.aws.amazon.com/opsworks/latest/APIReference/">OpsWorks</a>,
<a href="http://docs.aws.amazon.com/ses/latest/APIReference/">SES</a>,
<a href="http://docs.aws.amazon.com/amazonswf/latest/apireference/">SWF</a>,
<a href="http://docs.aws.amazon.com/AutoScaling/latest/APIReference/">AutoScaling</a>,
<a href="http://docs.aws.amazon.com/mobileanalytics/latest/ug/server-reference.html">Mobile Analytics</a>,
<a href="http://docs.aws.amazon.com/cognitoidentity/latest/APIReference/">Cognito Identity</a>,
<a href="http://docs.aws.amazon.com/cognitosync/latest/APIReference/">Cognito Sync</a>,
<a href="http://docs.aws.amazon.com/AmazonECS/latest/APIReference/">Container Service</a>,
<a href="http://docs.aws.amazon.com/appstream/latest/developerguide/appstream-api-rest.html">AppStream</a>,
<a href="http://docs.aws.amazon.com/kms/latest/APIReference/">Key Management Service</a>,
<a href="http://docs.aws.amazon.com/config/latest/APIReference/">Config</a>,
<a href="http://docs.aws.amazon.com/cloudhsm/latest/dg/api-ref.html">CloudHSM</a>,
<a href="http://docs.aws.amazon.com/Route53/latest/APIReference/requests-rest.html">Route53</a> and
<a href="http://docs.aws.amazon.com/Route53/latest/APIReference/requests-rpc.html">Route53 Domains</a>.</p>
<p>Indeed, the only AWS services that <em>don't</em> support v4 as of 2014-12-30 are
<a href="http://docs.aws.amazon.com/AWSImportExport/latest/DG/api-reference.html">Import/Export</a> and
<a href="http://docs.aws.amazon.com/AmazonSimpleDB/latest/DeveloperGuide/SDB_API.html">SimpleDB</a>
(they only support <a href="https://github.com/mhart/aws2">AWS Signature Version 2</a>).</p>
<p>It also provides defaults for a number of core AWS headers and
request parameters, making it very easy to query AWS services, or
build out a fully-featured AWS library.</p>
<h2><a class="anchor" aria-hidden="true" id="example"></a><a href="#example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h2>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">var</span> http  = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>),
    https = <span class="hljs-built_in">require</span>(<span class="hljs-string">'https'</span>),
    aws4  = <span class="hljs-built_in">require</span>(<span class="hljs-string">'aws4'</span>)

<span class="hljs-comment">// given an options object you could pass to http.request</span>
<span class="hljs-keyword">var</span> opts = {<span class="hljs-attr">host</span>: <span class="hljs-string">'sqs.us-east-1.amazonaws.com'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=ListQueues'</span>}

<span class="hljs-comment">// alternatively (as aws4 can infer the host):</span>
opts = {<span class="hljs-attr">service</span>: <span class="hljs-string">'sqs'</span>, <span class="hljs-attr">region</span>: <span class="hljs-string">'us-east-1'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=ListQueues'</span>}

<span class="hljs-comment">// alternatively (as us-east-1 is default):</span>
opts = {<span class="hljs-attr">service</span>: <span class="hljs-string">'sqs'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=ListQueues'</span>}

aws4.sign(opts) <span class="hljs-comment">// assumes AWS credentials are available in process.env</span>

<span class="hljs-built_in">console</span>.log(opts)
<span class="hljs-comment">/*
{
  host: 'sqs.us-east-1.amazonaws.com',
  path: '/?Action=ListQueues',
  headers: {
    Host: 'sqs.us-east-1.amazonaws.com',
    'X-Amz-Date': '20121226T061030Z',
    Authorization: 'AWS4-HMAC-SHA256 Credential=ABCDEF/20121226/us-east-1/sqs/aws4_request, ...'
  }
}
*/</span>

<span class="hljs-comment">// we can now use this to query AWS using the standard node.js http API</span>
http.request(opts, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{ res.pipe(process.stdout) }).end()
<span class="hljs-comment">/*
&lt;?xml version="1.0"?&gt;
&lt;ListQueuesResponse xmlns="http://queue.amazonaws.com/doc/2012-11-05/"&gt;
...
*/</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="more-options"></a><a href="#more-options" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>More options</h2>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// you can also pass AWS credentials in explicitly (otherwise taken from process.env)</span>
aws4.sign(opts, {<span class="hljs-attr">accessKeyId</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">secretAccessKey</span>: <span class="hljs-string">''</span>})

<span class="hljs-comment">// can also add the signature to query strings</span>
aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'s3'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/my-bucket?X-Amz-Expires=12345'</span>, <span class="hljs-attr">signQuery</span>: <span class="hljs-literal">true</span>})

<span class="hljs-comment">// create a utility function to pipe to stdout (with https this time)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">request</span>(<span class="hljs-params">o</span>) </span>{ https.request(o, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{ res.pipe(process.stdout) }).end(o.body || <span class="hljs-string">''</span>) }

<span class="hljs-comment">// aws4 can infer the HTTP method if a body is passed in</span>
<span class="hljs-comment">// method will be POST and Content-Type: 'application/x-www-form-urlencoded; charset=utf-8'</span>
request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'iam'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'Action=ListGroups&amp;Version=2010-05-08'</span>}))
<span class="hljs-comment">/*
&lt;ListGroupsResponse xmlns="https://iam.amazonaws.com/doc/2010-05-08/"&gt;
...
*/</span>

<span class="hljs-comment">// can specify any custom option or header as per usual</span>
request(aws4.sign({
  <span class="hljs-attr">service</span>: <span class="hljs-string">'dynamodb'</span>,
  <span class="hljs-attr">region</span>: <span class="hljs-string">'ap-southeast-2'</span>,
  <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.0'</span>,
    <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'DynamoDB_20120810.ListTables'</span>
  },
  <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>
}))
<span class="hljs-comment">/*
{"TableNames":[]}
...
*/</span>

<span class="hljs-comment">// works with all other services that support Signature Version 4</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'s3'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>, <span class="hljs-attr">signQuery</span>: <span class="hljs-literal">true</span>}))
<span class="hljs-comment">/*
&lt;ListAllMyBucketsResult xmlns="http://s3.amazonaws.com/doc/2006-03-01/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'ec2'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=DescribeRegions&amp;Version=2014-06-15'</span>}))
<span class="hljs-comment">/*
&lt;DescribeRegionsResponse xmlns="http://ec2.amazonaws.com/doc/2014-06-15/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'sns'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=ListTopics&amp;Version=2010-03-31'</span>}))
<span class="hljs-comment">/*
&lt;ListTopicsResponse xmlns="http://sns.amazonaws.com/doc/2010-03-31/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'sts'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=GetSessionToken&amp;Version=2011-06-15'</span>}))
<span class="hljs-comment">/*
&lt;GetSessionTokenResponse xmlns="https://sts.amazonaws.com/doc/2011-06-15/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'cloudsearch'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=ListDomainNames&amp;Version=2013-01-01'</span>}))
<span class="hljs-comment">/*
&lt;ListDomainNamesResponse xmlns="http://cloudsearch.amazonaws.com/doc/2013-01-01/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'ses'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=ListIdentities&amp;Version=2010-12-01'</span>}))
<span class="hljs-comment">/*
&lt;ListIdentitiesResponse xmlns="http://ses.amazonaws.com/doc/2010-12-01/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'autoscaling'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=DescribeAutoScalingInstances&amp;Version=2011-01-01'</span>}))
<span class="hljs-comment">/*
&lt;DescribeAutoScalingInstancesResponse xmlns="http://autoscaling.amazonaws.com/doc/2011-01-01/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'elasticloadbalancing'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=DescribeLoadBalancers&amp;Version=2012-06-01'</span>}))
<span class="hljs-comment">/*
&lt;DescribeLoadBalancersResponse xmlns="http://elasticloadbalancing.amazonaws.com/doc/2012-06-01/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'cloudformation'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=ListStacks&amp;Version=2010-05-15'</span>}))
<span class="hljs-comment">/*
&lt;ListStacksResponse xmlns="http://cloudformation.amazonaws.com/doc/2010-05-15/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'elasticbeanstalk'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=ListAvailableSolutionStacks&amp;Version=2010-12-01'</span>}))
<span class="hljs-comment">/*
&lt;ListAvailableSolutionStacksResponse xmlns="http://elasticbeanstalk.amazonaws.com/docs/2010-12-01/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'rds'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=DescribeDBInstances&amp;Version=2012-09-17'</span>}))
<span class="hljs-comment">/*
&lt;DescribeDBInstancesResponse xmlns="http://rds.amazonaws.com/doc/2012-09-17/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'monitoring'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=ListMetrics&amp;Version=2010-08-01'</span>}))
<span class="hljs-comment">/*
&lt;ListMetricsResponse xmlns="http://monitoring.amazonaws.com/doc/2010-08-01/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'redshift'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=DescribeClusters&amp;Version=2012-12-01'</span>}))
<span class="hljs-comment">/*
&lt;DescribeClustersResponse xmlns="http://redshift.amazonaws.com/doc/2012-12-01/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'cloudfront'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/2014-05-31/distribution'</span>}))
<span class="hljs-comment">/*
&lt;DistributionList xmlns="http://cloudfront.amazonaws.com/doc/2014-05-31/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'elasticache'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=DescribeCacheClusters&amp;Version=2014-07-15'</span>}))
<span class="hljs-comment">/*
&lt;DescribeCacheClustersResponse xmlns="http://elasticache.amazonaws.com/doc/2014-07-15/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'elasticmapreduce'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=DescribeJobFlows&amp;Version=2009-03-31'</span>}))
<span class="hljs-comment">/*
&lt;DescribeJobFlowsResponse xmlns="http://elasticmapreduce.amazonaws.com/doc/2009-03-31"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'route53'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/2013-04-01/hostedzone'</span>}))
<span class="hljs-comment">/*
&lt;ListHostedZonesResponse xmlns="https://route53.amazonaws.com/doc/2013-04-01/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'appstream'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/applications'</span>}))
<span class="hljs-comment">/*
{"_links":{"curie":[{"href":"http://docs.aws.amazon.com/appstream/latest/...
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'cognito-sync'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/identitypools'</span>}))
<span class="hljs-comment">/*
{"Count":0,"IdentityPoolUsages":[],"MaxResults":16,"NextToken":null}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'elastictranscoder'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/2012-09-25/pipelines'</span>}))
<span class="hljs-comment">/*
{"NextPageToken":null,"Pipelines":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'lambda'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/2014-11-13/functions/'</span>}))
<span class="hljs-comment">/*
{"Functions":[],"NextMarker":null}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'ecs'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/?Action=ListClusters&amp;Version=2014-11-13'</span>}))
<span class="hljs-comment">/*
&lt;ListClustersResponse xmlns="http://ecs.amazonaws.com/doc/2014-11-13/"&gt;
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'glacier'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/-/vaults'</span>, <span class="hljs-attr">headers</span>: {<span class="hljs-string">'X-Amz-Glacier-Version'</span>: <span class="hljs-string">'2012-06-01'</span>}}))
<span class="hljs-comment">/*
{"Marker":null,"VaultList":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'storagegateway'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'StorageGateway_20120630.ListGateways'</span>
}}))
<span class="hljs-comment">/*
{"Gateways":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'datapipeline'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'DataPipeline.ListPipelines'</span>
}}))
<span class="hljs-comment">/*
{"hasMoreResults":false,"pipelineIdList":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'opsworks'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'OpsWorks_20130218.DescribeStacks'</span>
}}))
<span class="hljs-comment">/*
{"Stacks":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'route53domains'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'Route53Domains_v20140515.ListDomains'</span>
}}))
<span class="hljs-comment">/*
{"Domains":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'kinesis'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'Kinesis_20131202.ListStreams'</span>
}}))
<span class="hljs-comment">/*
{"HasMoreStreams":false,"StreamNames":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'cloudtrail'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'CloudTrail_20131101.DescribeTrails'</span>
}}))
<span class="hljs-comment">/*
{"trailList":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'logs'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'Logs_20140328.DescribeLogGroups'</span>
}}))
<span class="hljs-comment">/*
{"logGroups":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'codedeploy'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'CodeDeploy_20141006.ListApplications'</span>
}}))
<span class="hljs-comment">/*
{"applications":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'directconnect'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'OvertureService.DescribeConnections'</span>
}}))
<span class="hljs-comment">/*
{"connections":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'kms'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'TrentService.ListKeys'</span>
}}))
<span class="hljs-comment">/*
{"Keys":[],"Truncated":false}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'config'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'StarlingDoveService.DescribeDeliveryChannels'</span>
}}))
<span class="hljs-comment">/*
{"DeliveryChannels":[]}
...
*/</span>

request(aws4.sign({<span class="hljs-attr">service</span>: <span class="hljs-string">'cloudhsm'</span>, <span class="hljs-attr">body</span>: <span class="hljs-string">'{}'</span>, <span class="hljs-attr">headers</span>: {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
  <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'CloudHsmFrontendService.ListAvailableZones'</span>
}}))
<span class="hljs-comment">/*
{"AZList":["us-east-1a","us-east-1b","us-east-1c"]}
...
*/</span>

request(aws4.sign({
  <span class="hljs-attr">service</span>: <span class="hljs-string">'swf'</span>,
  <span class="hljs-attr">body</span>: <span class="hljs-string">'{"registrationStatus":"REGISTERED"}'</span>,
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.0'</span>,
    <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'SimpleWorkflowService.ListDomains'</span>
  }
}))
<span class="hljs-comment">/*
{"domainInfos":[]}
...
*/</span>

request(aws4.sign({
  <span class="hljs-attr">service</span>: <span class="hljs-string">'cognito-identity'</span>,
  <span class="hljs-attr">body</span>: <span class="hljs-string">'{"MaxResults": 1}'</span>,
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-amz-json-1.1'</span>,
    <span class="hljs-string">'X-Amz-Target'</span>: <span class="hljs-string">'AWSCognitoIdentityService.ListIdentityPools'</span>
  }
}))
<span class="hljs-comment">/*
{"IdentityPools":[]}
...
*/</span>

request(aws4.sign({
  <span class="hljs-attr">service</span>: <span class="hljs-string">'mobileanalytics'</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/2014-06-05/events'</span>,
  <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({<span class="hljs-attr">events</span>:[{
    <span class="hljs-attr">eventType</span>: <span class="hljs-string">'a'</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
    <span class="hljs-attr">session</span>: {},
  }]}),
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
    <span class="hljs-string">'X-Amz-Client-Context'</span>: <span class="hljs-built_in">JSON</span>.stringify({
      <span class="hljs-attr">client</span>: {<span class="hljs-attr">client_id</span>: <span class="hljs-string">'a'</span>, <span class="hljs-attr">app_title</span>: <span class="hljs-string">'a'</span>},
      <span class="hljs-attr">custom</span>: {},
      <span class="hljs-attr">env</span>: {<span class="hljs-attr">platform</span>: <span class="hljs-string">'a'</span>},
      <span class="hljs-attr">services</span>: {},
    }),
  }
}))
<span class="hljs-comment">/*
(HTTP 202, empty response)
*/</span>

<span class="hljs-comment">// Generate CodeCommit Git access password</span>
<span class="hljs-keyword">var</span> signer = <span class="hljs-keyword">new</span> aws4.RequestSigner({
  <span class="hljs-attr">service</span>: <span class="hljs-string">'codecommit'</span>,
  <span class="hljs-attr">host</span>: <span class="hljs-string">'git-codecommit.us-east-1.amazonaws.com'</span>,
  <span class="hljs-attr">method</span>: <span class="hljs-string">'GIT'</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/v1/repos/MyAwesomeRepo'</span>,
})
<span class="hljs-keyword">var</span> password = signer.getDateTime() + <span class="hljs-string">'Z'</span> + signer.signature()
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="api"></a><a href="#api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>API</h2>
<h3><a class="anchor" aria-hidden="true" id="aws4signrequestoptions-credentials"></a><a href="#aws4signrequestoptions-credentials" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>aws4.sign(requestOptions, [credentials])</h3>
<p>This calculates and populates the <code>Authorization</code> header of
<code>requestOptions</code>, and any other necessary AWS headers and/or request
options. Returns <code>requestOptions</code> as a convenience for chaining.</p>
<p><code>requestOptions</code> is an object holding the same options that the node.js
<a href="http://nodejs.org/docs/latest/api/http.html#http_http_request_options_callback">http.request</a>
function takes.</p>
<p>The following properties of <code>requestOptions</code> are used in the signing or
populated if they don't already exist:</p>
<ul>
<li><code>hostname</code> or <code>host</code> (will be determined from <code>service</code> and <code>region</code> if not given)</li>
<li><code>method</code> (will use <code>'GET'</code> if not given or <code>'POST'</code> if there is a <code>body</code>)</li>
<li><code>path</code> (will use <code>'/'</code> if not given)</li>
<li><code>body</code> (will use <code>''</code> if not given)</li>
<li><code>service</code> (will be calculated from <code>hostname</code> or <code>host</code> if not given)</li>
<li><code>region</code> (will be calculated from <code>hostname</code> or <code>host</code> or use <code>'us-east-1'</code> if not given)</li>
<li><code>headers['Host']</code> (will use <code>hostname</code> or <code>host</code> or be calculated if not given)</li>
<li><code>headers['Content-Type']</code> (will use <code>'application/x-www-form-urlencoded; charset=utf-8'</code>
if not given and there is a <code>body</code>)</li>
<li><code>headers['Date']</code> (used to calculate the signature date if given, otherwise <code>new Date</code> is used)</li>
</ul>
<p>Your AWS credentials (which can be found in your
<a href="https://portal.aws.amazon.com/gp/aws/securityCredentials">AWS console</a>)
can be specified in one of two ways:</p>
<ul>
<li>As the second argument, like this:</li>
</ul>
<pre><code class="hljs css language-javascript">aws4.sign(requestOptions, {
  <span class="hljs-attr">secretAccessKey</span>: <span class="hljs-string">"&lt;your-secret-access-key&gt;"</span>,
  <span class="hljs-attr">accessKeyId</span>: <span class="hljs-string">"&lt;your-access-key-id&gt;"</span>,
  <span class="hljs-attr">sessionToken</span>: <span class="hljs-string">"&lt;your-session-token&gt;"</span>
})
</code></pre>
<ul>
<li>From <code>process.env</code>, such as this:</li>
</ul>
<pre><code class="hljs"><span class="hljs-builtin-name">export</span> <span class="hljs-attribute">AWS_SECRET_ACCESS_KEY</span>=<span class="hljs-string">"&lt;your-secret-access-key&gt;"</span>
<span class="hljs-builtin-name">export</span> <span class="hljs-attribute">AWS_ACCESS_KEY_ID</span>=<span class="hljs-string">"&lt;your-access-key-id&gt;"</span>
<span class="hljs-builtin-name">export</span> <span class="hljs-attribute">AWS_SESSION_TOKEN</span>=<span class="hljs-string">"&lt;your-session-token&gt;"</span>
</code></pre>
<p>(will also use <code>AWS_ACCESS_KEY</code> and <code>AWS_SECRET_KEY</code> if available)</p>
<p>The <code>sessionToken</code> property and <code>AWS_SESSION_TOKEN</code> environment variable are optional for signing
with <a href="http://docs.aws.amazon.com/STS/latest/UsingSTS/using-temp-creds.html">IAM STS temporary credentials</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="installation"></a><a href="#installation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<p>With <a href="http://npmjs.org/">npm</a> do:</p>
<pre><code class="hljs">npm <span class="hljs-keyword">install</span> aws4
</code></pre>
<p>Can also be used <a href="./browser">in the browser</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="thanks"></a><a href="#thanks" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Thanks</h2>
<p>Thanks to <a href="https://github.com/jed">@jed</a> for his
<a href="https://github.com/jed/dynamo-client">dynamo-client</a> lib where I first
committed and subsequently extracted this code.</p>
<p>Also thanks to the
<a href="https://github.com/aws/aws-sdk-js">official node.js AWS SDK</a> for giving
me a start on implementing the v4 signature.</p>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#aws4">aws4</a></li><li><a href="#example">Example</a></li><li><a href="#more-options">More options</a></li><li><a href="#api">API</a><ul class="toc-headings"><li><a href="#aws4signrequestoptions-credentials">aws4.sign(requestOptions, [credentials])</a></li></ul></li><li><a href="#installation">Installation</a></li><li><a href="#thanks">Thanks</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/underbase/" class="nav-home"><img src="/underbase/img/logo.svg" alt="Underbase" width="66" height="58"/></a><div><h5>Docs</h5><a href="/underbase/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/underbase/docs/en/doc2.html">Guides (or other categories)</a><a href="/underbase/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/underbase/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section></footer></div></body></html>